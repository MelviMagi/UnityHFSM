<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="max-width:448.535px;background-color:#fff" id="mermaid-1650462874938" width="100%" height="1324.864" viewBox="0 0 448.535 1324.864"><style>#mermaid-1650462874938{fill:#333}#mermaid-1650462874938,#mermaid-1650462874938 svg{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;font-size:16px}#mermaid-1650462874938 .label{font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif;color:#333}#mermaid-1650462874938 span{fill:#333;color:#333}#mermaid-1650462874938 .node path,#mermaid-1650462874938 .node polygon,#mermaid-1650462874938 .node rect{fill:#ececff;stroke:#9370db;stroke-width:1px}#mermaid-1650462874938 .node .label{text-align:center}#mermaid-1650462874938 .arrowheadPath{fill:#333}#mermaid-1650462874938 .edgePath .path{stroke:#333;stroke-width:2px}#mermaid-1650462874938 .edgeLabel{background-color:#e8e8e8;text-align:center}#mermaid-1650462874938 .edgeLabel rect{opacity:.5;background-color:#e8e8e8;fill:#e8e8e8}#mermaid-1650462874938 .cluster rect{fill:#ffffde;stroke:#aa3;stroke-width:1px}#mermaid-1650462874938 .cluster span{color:#333}#mermaid-1650462874938 :root{--mermaid-font-family:&quot;trebuchet ms&quot;,verdana,arial,sans-serif}</style><g><g class="output"><g class="clusters"><g style="opacity:1" id="flowchart-subGraph0-40" class="cluster" transform="translate(301.205078125,1119.8640594482422)"><rect width="278.66" height="216" x="-139.33" y="-108"/><g id="mermaid-1650462874938Text" class="label"><g transform="translate(0, -94) translate(-78.2890625,-9.5)"><foreignObject width="156.578" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Delayed State Change</div></foreignObject></g></g></g></g><g class="edgePaths"><g style="opacity:1" id="L-Start-NeedsExitTime" class="edgePath LS-Start LE-NeedsExitTime"><path style="fill:none" marker-end="url(#arrowhead85)" d="M166.2109375,47L166.2109375,51.166666666666664C166.2109375,55.333333333333336,166.2109375,63.666666666666664,166.29427083333334,72.08333333333333C166.37760416666666,80.5,166.54427083333334,89,166.62760416666666,93.25L166.7109375,97.5" class="path"/><defs><marker id="arrowhead85" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" id="L-NeedsExitTime-End" class="edgePath LS-NeedsExitTime LE-End"><path style="fill:none" marker-end="url(#arrowhead86)" d="M118.08167591221111,226.83167591221113L101.30113617684259,240.60321951017593C84.52059644147407,254.37476310814077,50.959516970737035,281.9178503040704,34.178977235368514,306.2727272353685C17.3984375,330.6276041666667,17.3984375,351.7942708333333,17.3984375,371.3776041666667C17.3984375,390.9609375,17.3984375,408.9609375,17.3984375,439.8838539123535C17.3984375,470.80677032470703,17.3984375,514.6526031494141,17.3984375,560.0817693074545C17.3984375,605.5109354654948,17.3984375,652.5234349568685,17.3984375,699.1820284525553C17.3984375,745.8406219482422,17.3984375,792.1453094482422,17.3984375,838.4499969482422C17.3984375,884.7546844482422,17.3984375,931.0593719482422,17.3984375,959.9617156982422C17.3984375,988.8640594482422,17.3984375,1000.3640594482422,17.3984375,1015.1140594482422C17.3984375,1029.8640594482422,17.3984375,1047.8640594482422,17.3984375,1067.4473927815754C17.3984375,1087.030726114909,17.3984375,1108.1973927815754,17.3984375,1127.780726114909C17.3984375,1147.3640594482422,17.3984375,1165.3640594482422,17.3984375,1181.780726114909C17.3984375,1198.1973927815754,17.3984375,1213.030726114909,17.3984375,1224.6140594482422C17.3984375,1236.1973927815754,17.3984375,1244.530726114909,25.831987359550563,1252.8640594482422C34.26553721910113,1261.1973927815754,51.132636938202246,1269.530726114909,59.56618679775281,1273.6973927815754L67.99973665730337,1277.8640594482422" class="path"/><defs><marker id="arrowhead86" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" id="L-NeedsExitTime-RequestExit" class="edgePath LS-NeedsExitTime LE-RequestExit"><path style="fill:none" marker-end="url(#arrowhead87)" d="M200.1679731451963,242.0039018548037L206.90950887099692,253.24674112900308C213.65104459679753,264.48958040320247,227.1341160483988,286.97525895160123,233.87565177419938,303.9680982258006C240.6171875,320.9609375,240.6171875,332.4609375,240.6171875,338.2109375L240.6171875,343.9609375" class="path"/><defs><marker id="arrowhead87" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" id="L-RequestExit-IsCanExitDefinined" class="edgePath LS-RequestExit LE-IsCanExitDefinined"><path style="fill:none" marker-end="url(#arrowhead88)" d="M240.6171875,401.9609375L240.6171875,406.1276041666667C240.6171875,410.2942708333333,240.6171875,418.6276041666667,240.70052083333334,427.04427108764645C240.78385416666666,435.4609380086263,240.95052083333334,443.9609385172526,241.03385416666666,448.21093877156574L241.1171875,452.46093902587893" class="path"/><defs><marker id="arrowhead88" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" id="L-IsCanExitDefinined-CanExitCallsStateCanExit" class="edgePath LS-IsCanExitDefinined LE-CanExitCallsStateCanExit"><path style="fill:none" marker-end="url(#arrowhead89)" d="M204.32310126859005,628.7418497427111L197.97107397382504,640.5408638602996C191.61904667906003,652.3398779778881,178.91499208953005,675.9379062130652,172.64629812809835,693.570253663987C166.37760416666666,711.2026011149088,166.54427083333334,722.8692677815756,166.62760416666666,728.702601114909L166.7109375,734.5359344482423" class="path"/><defs><marker id="arrowhead89" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" id="L-IsCanExitDefinined-Later" class="edgePath LS-IsCanExitDefinined LE-Later"><path style="fill:none" marker-end="url(#arrowhead90)" d="M291.90815061144735,614.7449759144316L304.77632342620615,628.8768023367334C317.6444962409649,643.0086287590351,343.38084187048247,671.2722816036386,356.2490146852412,708.5564517759403C369.1171875,745.8406219482422,369.1171875,792.1453094482422,369.1171875,838.4499969482422C369.1171875,884.7546844482422,369.1171875,931.0593719482422,369.1171875,959.9617156982422C369.1171875,988.8640594482422,369.1171875,1000.3640594482422,365.1497516396605,1010.2807261149088C361.182315779321,1020.1973927815756,353.247444058642,1028.530726114909,349.2800081983025,1032.6973927815754L345.31257233796293,1036.8640594482422" class="path"/><defs><marker id="arrowhead90" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" id="L-CanExitCallsStateCanExit-End" class="edgePath LS-CanExitCallsStateCanExit LE-End"><path style="fill:none" marker-end="url(#arrowhead91)" d="M135.67973845108696,912.3328603993291L130.97790704257247,923.1713935741478C126.27607563405797,934.0099267489668,116.87241281702899,955.6869930986045,112.17058140851448,972.2755262734232C107.46875,988.8640594482422,107.46875,1000.3640594482422,107.46875,1015.1140594482422C107.46875,1029.8640594482422,107.46875,1047.8640594482422,107.46875,1067.4473927815754C107.46875,1087.030726114909,107.46875,1108.1973927815754,107.46875,1127.780726114909C107.46875,1147.3640594482422,107.46875,1165.3640594482422,107.46875,1181.780726114909C107.46875,1198.1973927815754,107.46875,1213.030726114909,107.46875,1224.6140594482422C107.46875,1236.1973927815754,107.46875,1244.530726114909,107.46875,1252.8640594482422C107.46875,1261.1973927815754,107.46875,1269.530726114909,107.46875,1273.6973927815754L107.46875,1277.8640594482422" class="path"/><defs><marker id="arrowhead91" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" id="L-CanExitCallsStateCanExit-Later" class="edgePath LS-CanExitCallsStateCanExit LE-Later"><path style="fill:none" marker-end="url(#arrowhead92)" d="M203.97294483000272,906.1020521182395L210.52628215000223,917.9790533399067C217.0796194700018,929.8560545615737,230.1862941100009,953.610057004908,236.73963143000046,971.2370582265752C243.29296875,988.8640594482422,243.29296875,1000.3640594482422,249.03419174382717,1010.2807261149088C254.7754147376543,1020.1973927815756,266.2578607253086,1028.530726114909,271.9990837191358,1032.6973927815754L277.74030671296293,1036.8640594482422" class="path"/><defs><marker id="arrowhead92" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" id="L-Later-CallStateCanExit" class="edgePath LS-Later LE-CallStateCanExit"><path style="fill:none" marker-end="url(#arrowhead93)" d="M317.69921875,1094.8640594482422L317.69921875,1100.6140594482422C317.69921875,1106.3640594482422,317.69921875,1117.8640594482422,317.69921875,1129.3640594482422C317.69921875,1140.8640594482422,317.69921875,1152.3640594482422,317.69921875,1158.1140594482422L317.69921875,1163.8640594482422" class="path"/><defs><marker id="arrowhead93" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g><g style="opacity:1" id="L-CallStateCanExit-End" class="edgePath LS-CallStateCanExit LE-End"><path style="fill:none" marker-end="url(#arrowhead94)" d="M317.69921875,1202.8640594482422L317.69921875,1207.030726114909C317.69921875,1211.1973927815754,317.69921875,1219.530726114909,317.69921875,1227.8640594482422C317.69921875,1236.1973927815754,317.69921875,1244.530726114909,293.0201822916667,1253.9212650819402C268.3411458333333,1263.3118040489717,218.98307291666666,1273.7595486497014,194.30403645833334,1278.9834209500661L169.625,1284.207293250431" class="path"/><defs><marker id="arrowhead94" markerHeight="6" markerUnits="strokeWidth" markerWidth="8" orient="auto" refX="9" refY="5" viewBox="0 0 10 10"><path style="stroke-width:1;stroke-dasharray:1,0" d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath"/></marker></defs></g></g><g class="edgeLabels"><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect width="0" height="0" rx="0" ry="0"/><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-Start-NeedsExitTime" class="edgeLabel L-LS-Start' L-LE-NeedsExitTime"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(17.3984375,838.4499969482422) translate(-9.3984375,-9.5)"><rect width="18.797" height="19" rx="0" ry="0"/><foreignObject width="18.797" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-NeedsExitTime-End" class="edgeLabel L-LS-NeedsExitTime' L-LE-End">No</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(240.6171875,309.4609375) translate(-11.328125,-9.5)"><rect width="22.656" height="19" rx="0" ry="0"/><foreignObject width="22.656" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-NeedsExitTime-RequestExit" class="edgeLabel L-LS-NeedsExitTime' L-LE-RequestExit">Yes</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect width="0" height="0" rx="0" ry="0"/><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-RequestExit-IsCanExitDefinined" class="edgeLabel L-LS-RequestExit' L-LE-IsCanExitDefinined"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(166.2109375,699.5359344482422) translate(-11.328125,-9.5)"><rect width="22.656" height="19" rx="0" ry="0"/><foreignObject width="22.656" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-IsCanExitDefinined-CanExitCallsStateCanExit" class="edgeLabel L-LS-IsCanExitDefinined' L-LE-CanExitCallsStateCanExit">Yes</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(369.1171875,838.4499969482422) translate(-9.3984375,-9.5)"><rect width="18.797" height="19" rx="0" ry="0"/><foreignObject width="18.797" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-IsCanExitDefinined-Later" class="edgeLabel L-LS-IsCanExitDefinined' L-LE-Later">No</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(107.46875,1129.3640594482422) translate(-11.328125,-9.5)"><rect width="22.656" height="19" rx="0" ry="0"/><foreignObject width="22.656" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-CanExitCallsStateCanExit-End" class="edgeLabel L-LS-CanExitCallsStateCanExit' L-LE-End">Yes</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(243.29296875,977.3640594482422) translate(-9.3984375,-9.5)"><rect width="18.797" height="19" rx="0" ry="0"/><foreignObject width="18.797" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-CanExitCallsStateCanExit-Later" class="edgeLabel L-LS-CanExitCallsStateCanExit' L-LE-Later">No</span></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect width="0" height="0" rx="0" ry="0"/><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-Later-CallStateCanExit" class="edgeLabel L-LS-Later' L-LE-CallStateCanExit"/></div></foreignObject></g></g><g style="opacity:1" class="edgeLabel"><g class="label" transform="translate(0,0)"><rect width="0" height="0" rx="0" ry="0"/><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap"><span id="L-L-CallStateCanExit-End" class="edgeLabel L-LS-CallStateCanExit' L-LE-End"/></div></foreignObject></g></g></g><g class="nodes"><g style="opacity:1" id="flowchart-CallStateCanExit-37" class="node default" transform="translate(317.69921875,1183.3640594482422)"><rect width="155.031" height="39" x="-77.516" y="-19.5" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-67.515625,-9.5)"><foreignObject width="135.031" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">fsm.StateCanExit()</div></foreignObject></g></g></g><g style="opacity:1" id="flowchart-Later-31" class="node default" transform="translate(317.69921875,1065.8640594482422)"><rect width="175.672" height="58" x="-87.836" y="-29" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-77.8359375,-19)"><foreignObject width="155.672" height="38"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Later in<br/>activeState.OnLogic()</div></foreignObject></g></g></g><g style="opacity:1" id="flowchart-Start-20" class="node default" transform="translate(166.2109375,27.5)"><rect width="142.266" height="39" x="-71.133" y="-19.5" class="label-container" rx="19.5" ry="19.5"/><g class="label"><g transform="translate(0,0) translate(-56.2578125,-9.5)"><foreignObject width="112.516" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">State Transition</div></foreignObject></g></g></g><g style="opacity:1" id="flowchart-NeedsExitTime-21" class="node default" transform="translate(166.2109375,185.98046875)"><polygon points="88.98 0 177.961 -88.98 88.98 -177.961 0 -88.98" class="label-container" transform="translate(-88.98046875,88.98046875)"/><g class="label"><g transform="translate(0,0) translate(-59.8671875,-19)"><foreignObject width="119.734" height="38"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Does activeState<br/>need exit time</div></foreignObject></g></g></g><g style="opacity:1" id="flowchart-End-23" class="node default" transform="translate(107.46875,1297.3640594482422)"><rect width="124.313" height="39" x="-62.156" y="-19.5" class="label-container" rx="19.5" ry="19.5"/><g class="label"><g transform="translate(0,0) translate(-47.28125,-9.5)"><foreignObject width="94.563" height="19"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Change State</div></foreignObject></g></g></g><g style="opacity:1" id="flowchart-RequestExit-25" class="node default" transform="translate(240.6171875,372.9609375)"><rect width="203.031" height="58" x="-101.516" y="-29" class="label-container" rx="0" ry="0"/><g class="label"><g transform="translate(0,0) translate(-91.515625,-19)"><foreignObject width="183.031" height="38"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">FSM calls<br/>activeState.RequestExit()</div></foreignObject></g></g></g><g style="opacity:1" id="flowchart-IsCanExitDefinined-27" class="node default" transform="translate(240.6171875,558.4984359741211)"><polygon points="106.538 0 213.075 -106.538 106.538 -213.075 0 -106.538" class="label-container" transform="translate(-106.53750000000001,106.53750000000001)"/><g class="label"><g transform="translate(0,0) translate(-69.875,-28.5)"><foreignObject width="139.75" height="57"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Is<br/>activeState.canExit<br/>defined</div></foreignObject></g></g></g><g style="opacity:1" id="flowchart-CanExitCallsStateCanExit-29" class="node default" transform="translate(166.2109375,838.4499969482422)"><polygon points="104.414 0 208.828 -104.414 104.414 -208.828 0 -104.414" class="label-container" transform="translate(-104.4140625,104.4140625)"/><g class="label"><g transform="translate(0,0) translate(-67.515625,-28.5)"><foreignObject width="135.031" height="57"><div xmlns="http://www.w3.org/1999/xhtml" style="display:inline-block;white-space:nowrap">Does<br/>canExit call<br/>fsm.StateCanExit()</div></foreignObject></g></g></g></g></g></g></svg>